<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asseria Gradnja</title>
  <style>
    body { font-family:sans-serif; margin:0; padding:0; background:#f4f4f4; color:#222 }
    header { min-height:300px; background:#222; color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; }
    nav { background:#c8102e; color:#fff; text-align:center; padding:.5rem }
    nav a { color:#fff; margin:0 1rem; text-decoration:none }
    section { padding:2rem; max-width:1000px; margin:auto }
    footer { background:#222; color:#fff; text-align:center; padding:1rem }
    .admin-login,.admin-panel { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; padding:1rem; border:1px solid #ccc; border-radius:8px; z-index:1000; display:none; width:320px }
    .tabs{display:flex;gap:.5rem;margin-bottom:1rem}
    .tabs button{flex:1;padding:.5rem}
    .tab-content{display:none}
    .tab-content.active{display:block}
    input,textarea,button{width:100%;margin:.3rem 0;padding:.5rem}
    .btn{background:#c8102e;color:#fff;border:none;border-radius:5px;cursor:pointer}
  </style>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
</head>
<body>

<header id="hero">
  <h1 id="hero-title">Asseria Gradnja</h1>
  <p id="hero-sub">Uređenje enterijera i eksterijera • Ključ u ruke</p>
</header>
<nav>
  <a href="#onama">O nama</a>
  <a href="#usluge">Usluge</a>
  <a href="#galerija">Galerija</a>
  <a href="#shop">Shop</a>
  <a href="#kontakt">Kontakt</a>
</nav>

<section id="onama">
  <h2 id="about-title">O nama</h2>
  <p id="about-text">Specijalizirani smo za renoviranje kuća i stanova te niskogradnju sistemom ključ u ruke.</p>
</section>

<section id="usluge">
  <h2>Naše usluge</h2>
  <ul id="services"></ul>
</section>

<section id="galerija">
  <h2>Galerija</h2>
  <div id="gallery"></div>
</section>

<section id="shop">
  <h2>Shop</h2>
  <div id="shop-items"></div>
</section>

<section id="kontakt">
  <h2>Kontakt</h2>
  <p>📞 <span id="contact-phone">+385 91 123 4567</span></p>
  <p>✉️ <span id="contact-email">info@asseria-gradnja.hr</span></p>
  <p>📍 <span id="contact-address">Benkovačko selo 122, 23420 Benkovac</span></p>
</section>

<footer>
  <p id="footer-text">© 2025 Asseria Gradnja</p>
  <button onclick="showLogin()" class="btn">🔑 Admin</button>
</footer>

<!-- Admin Login -->
<div class="admin-login" id="admin-login">
  <h3>Prijava</h3>
  <input type="email" id="loginUser" placeholder="Email">
  <input type="password" id="loginPass" placeholder="Lozinka">
  <button onclick="login()" class="btn">Login</button>
  <button onclick="hideLogin()" class="btn">Zatvori</button>
</div>

<!-- Admin Panel -->
<div class="admin-panel" id="admin-panel">
  <h3>Admin panel</h3>
  <div class="tabs">
    <button onclick="openTab('general')">Općenito</button>
    <button onclick="openTab('about')">O nama</button>
    <button onclick="openTab('services')">Usluge</button>
    <button onclick="openTab('gallery')">Galerija</button>
    <button onclick="openTab('shop')">Shop</button>
    <button onclick="openTab('contact')">Kontakt</button>
    <button onclick="openTab('footer')">Footer</button>
  </div>
  <div id="tab-general" class="tab-content">
    <h4>Hero naslov</h4><input id="heroTitleInput">
    <h4>Hero opis</h4><input id="heroSubInput">
    <button onclick="saveGeneral()" class="btn">Spremi</button>
  </div>
  <div id="tab-about" class="tab-content">
    <h4>O nama naslov</h4><input id="aboutTitleInput">
    <h4>O nama tekst</h4><textarea id="aboutTextInput"></textarea>
    <button onclick="saveAbout()" class="btn">Spremi</button>
  </div>
  <div id="tab-services" class="tab-content">
    <input id="svcName" placeholder="Naziv"><input id="svcDesc" placeholder="Opis">
    <button onclick="addService()" class="btn">Dodaj</button>
    <ul id="servicesAdmin"></ul>
  </div>
  <div id="tab-gallery" class="tab-content">
    <input type="file" id="galInput"><button onclick="addGallery()" class="btn">Dodaj</button>
    <div id="galleryAdmin"></div>
  </div>
  <div id="tab-shop" class="tab-content">
    <input id="itemName" placeholder="Naziv"><input id="itemPrice" placeholder="Cijena">
    <input type="file" id="itemImg"><button onclick="addItem()" class="btn">Dodaj</button>
    <div id="shopAdmin"></div>
  </div>
  <div id="tab-contact" class="tab-content">
    <h4>Telefon</h4><input id="contactPhoneInput">
    <h4>Email</h4><input id="contactEmailInput">
    <h4>Adresa</h4><input id="contactAddressInput">
    <button onclick="saveContact()" class="btn">Spremi</button>
  </div>
  <div id="tab-footer" class="tab-content">
    <h4>Footer tekst</h4><input id="footerTextInput">
    <button onclick="saveFooter()" class="btn">Spremi</button>
  </div>
  <button onclick="hideAdmin()" class="btn">Zatvori</button>
</div>

<script>
  // 🔥 Firebase config – OVDJE ubaciš svoj config iz Firebase konzole
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();
  const storage = firebase.storage();

  // Helperi
  function showLogin(){ document.getElementById('admin-login').style.display='block'; }
  function hideLogin(){ document.getElementById('admin-login').style.display='none'; }
  function hideAdmin(){ document.getElementById('admin-panel').style.display='none'; }
  function openTab(t){ document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active')); document.getElementById('tab-'+t).classList.add('active'); }

  // Login
  function login(){
    const email=document.getElementById('loginUser').value;
    const pass=document.getElementById('loginPass').value;
    auth.signInWithEmailAndPassword(email,pass)
      .then(()=>{ document.getElementById('admin-login').style.display='none'; document.getElementById('admin-panel').style.display='block'; })
      .catch(err=>alert("Greška: "+err.message));
  }

  // --- Firestore & Storage funkcije ---
  async function saveGeneral(){
    await db.collection("content").doc("general").set({
      heroTitle: heroTitleInput.value,
      heroSub: heroSubInput.value
    });
  }

  async function saveAbout(){
    await db.collection("content").doc("about").set({
      title: aboutTitleInput.value,
      text: aboutTextInput.value
    });
  }

  async function addService(){
    await db.collection("services").add({
      name: svcName.value,
      desc: svcDesc.value
    });
  }

  async function addGallery(){
    const file = document.getElementById("galInput").files[0];
    if(!file) return;
    const ref = storage.ref("gallery/"+file.name);
    await ref.put(file);
    const url = await ref.getDownloadURL();
    await db.collection("gallery").add({ url });
  }

  async function addItem(){
    const file=document.getElementById("itemImg").files[0];
    if(!file) return;
    const ref=storage.ref("shop/"+file.name);
    await ref.put(file);
    const url=await ref.getDownloadURL();
    await db.collection("shop").add({
      name:itemName.value,
      price:itemPrice.value,
      img:url
    });
  }

  async function saveContact(){
    await db.collection("content").doc("contact").set({
      phone: contactPhoneInput.value,
      email: contactEmailInput.value,
      address: contactAddressInput.value
    });
  }

  async function saveFooter(){
    await db.collection("content").doc("footer").set({
      text: footerTextInput.value
    });
  }

  // --- Real-time čitanje ---
  db.collection("content").doc("general").onSnapshot(doc=>{
    if(doc.exists){
      const d=doc.data();
      document.getElementById("hero-title").innerText=d.heroTitle||"";
      document.getElementById("hero-sub").innerText=d.heroSub||"";
    }
  });

  db.collection("content").doc("about").onSnapshot(doc=>{
    if(doc.exists){
      const d=doc.data();
      document.getElementById("about-title").innerText=d.title||"";
      document.getElementById("about-text").innerText=d.text||"";
    }
  });

  db.collection("services").onSnapshot(snap=>{
    const ul=document.getElementById("services"); ul.innerHTML="";
    const adminUl=document.getElementById("servicesAdmin"); adminUl.innerHTML="";
    snap.forEach(doc=>{
      const d=doc.data();
      ul.innerHTML+=`<li>${d.name} - ${d.desc}</li>`;
      adminUl.innerHTML+=`<li>${d.name} - ${d.desc}</li>`;
    });
  });

  db.collection("gallery").onSnapshot(snap=>{
    const g=document.getElementById("gallery"); g.innerHTML="";
    const gAdmin=document.getElementById("galleryAdmin"); gAdmin.innerHTML="";
    snap.forEach(doc=>{
      const d=doc.data();
      g.innerHTML+=`<img src="${d.url}" width="200">`;
      gAdmin.innerHTML+=`<div><img src="${d.url}" width="80"></div>`;
    });
  });

  db.collection("shop").onSnapshot(snap=>{
    const s=document.getElementById("shop-items"); s.innerHTML="";
    const sAdmin=document.getElementById("shopAdmin"); sAdmin.innerHTML="";
    snap.forEach(doc=>{
      const d=doc.data();
      s.innerHTML+=`<div><img src="${d.img}" width="100"><h4>${d.name}</h4><p>${d.price} €</p></div>`;
      sAdmin.innerHTML+=`<div><img src="${d.img}" width="80">${d.name} ${d.price}€</div>`;
    });
  });

  db.collection("content").doc("contact").onSnapshot(doc=>{
    if(doc.exists){
      const d=doc.data();
      document.getElementById("contact-phone").innerText=d.phone||"";
      document.getElementById("contact-email").innerText=d.email||"";
      document.getElementById("contact-address").innerText=d.address||"";
    }
  });

  db.collection("content").doc("footer").onSnapshot(doc=>{
    if(doc.exists){
      document.getElementById("footer-text").innerText=doc.data().text||"";
    }
  });

</script>
</body>
</html>
